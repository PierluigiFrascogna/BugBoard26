server:
  port: 8080  # Il Gateway gira sulla porta standard, punto di ingresso unico

spring:
  application:
    name: bugboard-gateway
  
  cloud:
    gateway:
      # Configurazione CORS globale (fondamentale per far comunicare Angular con Spring)
      globalcors:
        cors-configurations:
          '[/**]':
            allowedOrigins: "http://localhost:4200" # URL del frontend Angular
            allowedMethods:
              - GET
              - POST
              - PUT
              - DELETE
              - OPTIONS
            allowedHeaders: "*"
            allowCredentials: true

      routes:
        # ---------------------------------------------------------
        # ROTTA 1: Servizio Gestione Utenze
        # Gestisce: Login, Registrazione (Funzionalità 1 e 15 per creazione utenti)
        # Riferimento doc architettura: [cite: 500, 517]
        # ---------------------------------------------------------
        - id: user-service
          uri: http://localhost:8081 # Ipotizziamo che il microservizio utenze giri sulla 8081
          predicates:
            - Path=/api/auth/**, /api/users/**
          filters:
            # Rimuove /api/users prima di inoltrare la richiesta se il microservizio non lo prevede
            # Es: Gateway: /api/users/login -> Microservizio: /login
            # Se invece il microservizio ha già il context-path /api/users, rimuovi questa riga.
            - StripPrefix=0 

        # ---------------------------------------------------------
        # ROTTA 2: Servizio Gestione Issue (BugBoard)
        # Gestisce: Issue, Commenti, Cronologia (Funzionalità 2, 3, 5, 12)
        # Riferimento doc architettura: [cite: 501, 518]
        # ---------------------------------------------------------
        - id: issue-service
          uri: http://localhost:8082 # Ipotizziamo che il microservizio issue giri sulla 8082
          predicates:
            - Path=/api/issues/**, /api/projects/**, /api/comments/**